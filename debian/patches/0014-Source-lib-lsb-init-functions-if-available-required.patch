From: Mathieu Parent <math.parent@gmail.com>
Date: Wed, 12 Feb 2014 18:06:21 +0100
Subject: Source /lib/lsb/init-functions if available (required)

---
 bin/init.d/shinken-arbiter     | 4 ++++
 bin/init.d/shinken-broker      | 4 ++++
 bin/init.d/shinken-poller      | 4 ++++
 bin/init.d/shinken-reactionner | 4 ++++
 bin/init.d/shinken-receiver    | 4 ++++
 bin/init.d/shinken-scheduler   | 4 ++++
 bin/init.d/shinken.in          | 4 +++-
 7 files changed, 27 insertions(+), 1 deletion(-)

Index: shinken/bin/init.d/shinken-arbiter
===================================================================
--- shinken.orig/bin/init.d/shinken-arbiter
+++ shinken/bin/init.d/shinken-arbiter
@@ -23,6 +23,10 @@ curdir=$(dirname "$0")
 
 export SHINKEN_MODULE_FILE="$NAME"  ## for 'shinken' init script to see that it's called by us
 
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
+
 "$curdir/shinken" $@ arbiter
 
 exit $?
Index: shinken/bin/init.d/shinken-broker
===================================================================
--- shinken.orig/bin/init.d/shinken-broker
+++ shinken/bin/init.d/shinken-broker
@@ -29,6 +29,10 @@ curdir=$(dirname "$0")
 
 export SHINKEN_MODULE_FILE="$NAME"  ## for 'shinken' init script to see that it's called by us
 
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
+
 "$curdir/shinken" $@ broker
 
 exit $?
Index: shinken/bin/init.d/shinken-poller
===================================================================
--- shinken.orig/bin/init.d/shinken-poller
+++ shinken/bin/init.d/shinken-poller
@@ -30,6 +30,10 @@ curdir=$(dirname "$0")
 
 export SHINKEN_MODULE_FILE="$NAME"  ## for 'shinken' init script to see that it's called by us
 
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
+
 "$curdir/shinken" $@ poller
 
 exit $?
Index: shinken/bin/init.d/shinken-reactionner
===================================================================
--- shinken.orig/bin/init.d/shinken-reactionner
+++ shinken/bin/init.d/shinken-reactionner
@@ -29,6 +29,10 @@ curdir=$(dirname "$0")
 
 export SHINKEN_MODULE_FILE="$NAME"  ## for 'shinken' init script to see that it's called by us
 
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
+
 "$curdir/shinken" $@ reactionner
 
 exit $?
Index: shinken/bin/init.d/shinken-receiver
===================================================================
--- shinken.orig/bin/init.d/shinken-receiver
+++ shinken/bin/init.d/shinken-receiver
@@ -29,6 +29,10 @@ curdir=$(dirname "$0")
 
 export SHINKEN_MODULE_FILE="$NAME"  ## for 'shinken' init script to see that it's called by us
 
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
+
 "$curdir/shinken" $@ receiver
 
 exit $?
Index: shinken/bin/init.d/shinken-scheduler
===================================================================
--- shinken.orig/bin/init.d/shinken-scheduler
+++ shinken/bin/init.d/shinken-scheduler
@@ -29,6 +29,10 @@ curdir=$(dirname "$0")
 
 export SHINKEN_MODULE_FILE="$NAME"  ## for 'shinken' init script to see that it's called by us
 
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
+
 "$curdir/shinken" $@ scheduler
 
 exit $?
Index: shinken/bin/init.d/shinken.in
===================================================================
--- shinken.orig/bin/init.d/shinken.in
+++ shinken/bin/init.d/shinken.in
@@ -170,7 +170,9 @@ echo_failure() {
 # Source function library.
 [ -f /etc/rc.d/init.d/functions ] && . /etc/rc.d/init.d/functions
 
-[ -f /lib/lsb/init-functions ] && . /lib/lsb/init-functions
+if [ -f /lib/lsb/init-functions ]; then
+. /lib/lsb/init-functions
+fi
 
 
 
